+import('../../bower_components/core-icons/core-icons.html')
+import('../../bower_components/core-drawer-panel/core-drawer-panel.html')
+import('../../bower_components/core-header-panel/core-header-panel.html')
+import('../../bower_components/core-toolbar/core-toolbar.html')
+import('../../bower_components/paper-icon-button/paper-icon-button.html')
+import('./cards/ticker-github-events-card.html')
+import('./ticker-search.html')

+polymer-element

  core-drawer-panel#drawerPanel(drawerWidth='320px' narrow='{{narrow}}')
    //- TODO(pwong): extract to seperate element
    core-header-panel(drawer mode='seamed')
      core-toolbar(class='{{!narrow && "medium-tall"}} c-white')
        .toolbar__title.bottom(
          layout horizontal center
          class='l-margin-l2 t-font-size-24 t-normal'
        )
          core-icon(icon='alarm' class='l-margin-r2')
          | Ticker

      .drawer
        template(if='{{narrow}}')
          paper-item.drawer__item(
            class='{{ isSearching && "is-selected" }} \
                   u-border-b1 c-border-gray-lightest'
            on-tap='{{onSelectSearch}}'
          )
            core-icon.drawer__item__icon(icon='search')
            | Search

        template(repeat='{{eventStream, i in session.user.eventStreams}}')
          paper-item.drawer__item(
            class='{{ { "is-selected": eventStream === selectedEventStream, \
                        "l-padding-t2": i == 0 } | tokenList }}'
            on-tap='{{onSelectEventStream}}'
          )
            core-icon.drawer__item__icon(
              icon='{{  eventStream.config.type === "repos" ? "github:repo"   \
                      : eventStream.config.type === "users" ? "github:person" \
                      : "github:star" }}'
            )
            | {{eventStream.name}}

    core-header-panel(main mode="{{narrow ? 'waterfall' : 'cover'}}")
      #content.ticker-app__content(main fit class='l-padding-h2 l-overflow-scroll-ios')
        ticker-github-events-card(block events='{{events}}')

      template(if='{{!isSearching}}')
        core-toolbar(class='{{!narrow && "medium-tall"}} c-white')
          template(if='{{narrow}}')
            paper-icon-button(class='l-margin-l2 l-margin-r0' icon='menu' on-tap='{{onOpenDrawer}}')
            span.toolbar__title(flex class='l-margin-l1 t-font-size-20 t-normal t-truncate') {{selectedEventStream.name}}

      template(if='{{isSearching}}')
        ticker-search(
          fit
          on-ticker-search-close='{{onCloseSearch}}'
          on-ticker-search-select='{{onSearchSelect}}'
        )
