+import('../../iconsets/github.html')
+import('../../../bower_components/core-icon/core-icon.html')
+import('../ticker-card.html')
+import('./ticker-github-branch.html')
+import('./ticker-github-repo.html')
+import('./ticker-github-avatar.html')

template#PullRequestEvent
  ticker-github-repo.ticker-github-events-card__title(repo='{{repo.name}}')
  div(layout horizontal center)
    ticker-github-avatar(class='l-margin-r2' userid='{{actor.id}}')
    core-icon(
      class='{{   payload.pullRequest.state === "open" ? "c-color-warning"    \
                : payload.pullRequest.merged           ? "c-color-confirm"    \
                                                       : "c-color-error"   }} \
             l-margin-r2'
      icon='github:git-pull-request')
    span(flex)
      | {{payload.pullRequest.title}}

template#CreateOrDeleteEvent
  template(if='{{payload.refType === "repository"}}')
    div(layout horizontal center)
      ticker-github-avatar(class='l-margin-r2' userid='{{actor.id}}')
      core-icon(class='c-{{iconColor}} l-margin-r2' icon='github:repo')
      ticker-github-repo(repo='{{repo.name}}')

  template(if='{{payload.refType !== "repository"}}')
    ticker-github-repo(block repo='{{repo.name}}')
    div(layout horizontal center)
      ticker-github-avatar(class='l-margin-r2' userid='{{actor.id}}')
      core-icon(class='c-{{iconColor}} l-margin-r2' icon='github:git-branch')
      span(flex) {{payload.ref}}


template#CreateEvent
  template(bind='{{"color-confirm" as iconColor}}')
    template(ref='CreateOrDeleteEvent' bind='{{}}')


template#DeleteEvent
  template(bind='{{"color-error" as iconColor}}')
    template(ref='CreateOrDeleteEvent' bind='{{}}')


template#IssueCommentEvent
  ticker-github-repo.ticker-github-events-card__title(repo='{{repo.name}}')
  div(layout horizontal class='l-margin-l6 l-margin-b2 t-light')
    core-icon(
      class='c-color-gray-lighter l-margin-h1 l-margin-r2'
      icon='{{payload.issue.pullRequest ? "github:git-pull-request" \
                                        : "github:issue-opened"     }}'
    )
    span(flex) {{payload.issue.title}}
  div(layout horizontal center-top)
    ticker-github-avatar(class='l-margin-r2' userid='{{actor.id}}')
    div(flex layout horizontal)
      core-icon(
        class='c-color-brand-primary-lighter l-float-l l-margin-r2'
        icon='github:comment-discussion'
      )
      div(flex class='t-italic t-word-wrap-break-word')
        span() "
        span(class='l-margin-h25pct')| {{payload.comment.body}}
        span() "

template#IssuesEvent
  ticker-github-repo.ticker-github-events-card__title(repo='{{repo.name}}')
  div(layout horizontal center-top)
    ticker-github-avatar(class='l-margin-r2' userid='{{actor.id}}')
    core-icon(
      class='{{   payload.action === "opened"   ? "c-color-warning"    \
                : payload.action === "reopened" ? "c-color-warning"    \
                                                : "c-color-confirm" }} \
            l-margin-r2'
      icon='github:issue-{{payload.action}}'
    )
    span(flex) {{payload.issue.title}}


template#WatchEvent
  div(layout horizontal center)
    ticker-github-avatar(class='l-margin-r2' userid='{{actor.id}}')
    core-icon(
      class='c-color-gray-lightest l-margin-r1'
      icon='github:star'
    )
    ticker-github-repo(repo='{{repo.name}}')


template#ForkEvent
  div(layout horizontal center)
    ticker-github-avatar(class='l-margin-r2' userid='{{actor.id}}')
    core-icon(
      class='c-color-gray-lightest l-margin-r1'
      icon='github:repo-forked'
    )
    ticker-github-repo(repo='{{repo.name}}')


template#PushEvent
  ticker-github-repo.ticker-github-events-card__title(repo='{{repo.name}}')
  div(horizontal layout class='l-margin-l6 l-margin-b2 t-light')
    core-icon(
      class='c-color-gray-lighter l-margin-h1 l-margin-r2'
      icon='github:git-branch'
    )
    ticker-github-branch(branch='{{payload.ref}}')
  div(layout horizontal center-top)
    ticker-github-avatar(class='l-margin-r2' userid='{{actor.id}}')
    ul.ticker-github-pushevent__commits(flex)
      template(repeat='{{commit in limitArray(payload.commits, 3)}}')
        li(class='l-margin-b50pct t-truncate')
          core-icon(class='c-color-confirm l-margin-r2' icon='github:git-commit')
          | {{commit.message}}


template#GollumEvent
  ticker-github-repo.ticker-github-events-card__title(repo='{{repo.name}}')
  div(layout horizontal center-top)
    ticker-github-avatar(class='l-margin-r2' userid='{{actor.id}}')
    core-icon(class='c-color-confirm l-margin-r2' icon='github:book')
    div {{payload.pages[0].title}}

+polymer-element(attributes='data')
  //- div.c-color-gray-light.l-margin-b1.l-margin-l2.l-margin-t4 {{data.type}}
  ticker-card(class='c-color-gray-darker l-padding-v2 l-padding-h2' layout vertical)
    template(ref='{{data.type}}' bind='{{data}}')
